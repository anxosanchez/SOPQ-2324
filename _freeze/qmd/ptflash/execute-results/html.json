{
  "hash": "bc4ab3ab4af728c0a07beeccfa68a900",
  "result": {
    "markdown": "---\ntitle: Cálculos Flash\ncategories:\n  - Equilibrio VLE\n  - Separacións FLASH\n  - Puntos orballo e burbulla\n---\n\n![image.png](../imaxes/pTflash_light.png)\n\nOs cálculos de flash úsanse para procesos de equilibrio vapor/líquido (VLE). Un proceso típico que require cálculos de flash, é o representado na figura 1. Un caudal de alimentación dunha mestura de compoñentes $F$ se separada nun vapor $V$ e un líquido $L$.\n\nEn principio, os cálculos de flash son sinxelos e implican combinar o as ecuacións do equilibrio líquido-vapor cos balances de materia dos compoñentes da mestura e, nalgúns casos, o balance de enerxía.\n\nAlgúns cálculos de flash son:\n1. Punto de burbulla a unha temperatura $T$ dada (fácil).\n2. Punto de burbulla a unha presión $p$ dada (supón facer un cálculo iterativo en T).\n3. Punto de orballo a unha temperatura $T$ dada (fácil).\n4. Punto de orballo a una presión $p$ dada (supón facer un cálculo iterativo en T).\n5. Flash dadas $p$ e $T$ (relativamente fácil).\n6. Flash dadas $p$ e $H$ (flash \"estándar\", por exemplo, para un tanque flash colocado despois dunha válvula).\n7. Flash dadas $p$ e $S$ (por exemplo, para a turbina de condensación).\n8. Flash dadas $U$ e $V$ (por exemplo, para a simulación dinámica dun tanque adiabático).\n\nOs tres últimos flashes son un pouco máis complicados xa que requiren o cálculodo balance de enerxía e as relacións de equilibrio para o cálculo de $H$, $S$, etc. \n\nNos exemplos de cálculos flash que se propoñen aquí, supoñemos que o equilibrio entre o líquido e o vapor (VLE) está dado en forma de valores _K_, é dicir:\né dicir,\n  \n$$\ny_i=K_ix_i\n$$\n  \nonde $y_i$ son as fraccións molares da fase vapor e $x_i$ as fraccións molares da fase líquida para\ncada compoñente $i$. En xeral, o $K$ depende da temperatura $T$, presión $p$ e composición (tanto $x_i$ como $y_i$). Supondremos que as mesturas son ideais e utilizaremos a **Lei de Raoult**:\n  \n$$\nK_i = \\frac {p_i^{sat}(T)} {p}\n$$\n  \nNeste caso $K_i$ dependen só de $T$ e $p$:\n\n\nNos exemplos, calculamos a presión de vapor ou presión de saturación, $p_i^{sat}(T)$, usando os parámetros de **Antoine** indicados na táboa 1.\n\nindicado na táboa 7.2.Onde yi é a fracción de mole en fase de vapor e xi a fracción de mol de fase líquida para\ncompoñente i. En xeral, o \"valor K\" depende da temperatura T, presión p e composición (tanto xi como yi). Aceptamos principalmente mesturas ideais e utilizamos a **lei de Raoult**:\nNeste caso $K_i$ depende de $T$ e $p$ só. A lei de Raoult:\n  \n$$\nKi = psat_i (T) / p\n$$\n  \nNos exemplos, calculamos o psat de presión de vapor ($T$) usando os **parámetros de Antoine** dados na táboa 1.\n\nTáboa 1: Datos das constantes de **Antoine**, temperatura de fervura e entalpía de vaporización para resolver os problemas. A os valores das constantes da **Ecuación de Antoine** en esta táboa son para as presións de vapor expresadas en bar, as temperaturas en K e as entalpías en J/mol.\n\n| Composto | A | B | C | T<sub>b</sub> (K) | $\\Delta$ H<sub>vap</sub> | \n|:-----------|-------------|------------|------------|---------------|---------------|\n| Pentano (C<sub>5</sub>H<sub>12</sub>) | 3.97786 | 1064.840 | -41.136 | 309.22 | 25790 |\n| Hexano (C<sub>6</sub>H<sub>14</sub>) | 4.00139 | 1170.875 | -48.833 | 341.88 | 28850 |\n| Ciclohexano (C<sub>6</sub>H<sub>12</sub>) | 3.93002 | 1182.774 | -52.532 | 353.93 | 29970 |\n| Metanol (CH<sub>3</sub>OH) | 5.20277 | 1580.080 | -33.650 | 337.69 | 35210 |\n| Auga (H<sub>2</sub>O) | 5.11564 | 1687.537 | -42.98 | 373.15 | 40660 |\n| Amoníaco (NH<sub>3</sub>) | 4.48540 | 926.132 | -32.98 | 239.82 | 23350 |\n| Propano (C<sub>3</sub>H<sub>8</sub>) | 3.92828 | 803.997 | -26.11 | 231.02 | 19040 |\n| Octano (C<sub>8</sub>H<sub>18</sub>) | 4.05075 | 1356.360 | -63.515 | 398.82 | 34410 |\n| Dodecano (C<sub>12</sub>H<sub>26</sub>) | 4.12285 | 1639.270 | -91.310 | 489.48 | 43400 |\n| Benceno (C<sub>6</sub>H<sub>6</sub>) | 3.98523 | 1184.24 | -55.578 | 353.24 | 30720 |\n| Tolueno (C<sub>7</sub>H<sub>8</sub>) | 4.05043 | 1327.62 | -55.525 | 383.79 | 33180 |\n  \n  \n<small>\nTáboa 1: Datos das constantes de **Antoine**, temperrtura de fervura e entalpía de vaporización para resolver os problemas. A os valores das constantes da **Ecuación de Antoine** en esta táboa son para as presións de vapor expresadas en bar, as temperaturas en K e as entalpías en J/mol.\n</small>\n\n## Cálculos de puntos de burbulla\n\nConsideremos primeiro os cálculos de punto de burbulla, neste caso dannos a composición da fase líquida $x_i$ (corresponde ao caso en que V é moi pequena (V $\\geq$ 0) e $x_i$ = $z_i$ na Figura 1). \n\nO punto de burbulla dun líquido é o punto no que o líquido xusto comeza a evaporarse (ferver), é dicir, cando se forma a primeira burbulla de vapor. Se coñecemos a temperatura, entón debemos baixar a presión ata que se forme a primeira burbulla. Se coñecemos a presión. debemos aumentar a temperatura ata que se forme a primeira burbulla. Nos dous casos, isto corresponde axustar $T$ ou $p$ ata que a suma das fraccións de vapor de todos os compoñenetes sea a unidade, $\\sum y_i$ = 1 ou:\n  \n$$\n\\sum K_i x_i = 1\n$$\n\nonde as $x_i$ son ceñecidas. Para o caso ideal, no que se cumpre a __Lei de Raoult__:\n  \n$$\n\\Sigma_{i} \\underbrace{x_{i} p_{i}^{\\text {siat }}(T)}_{p_{i}}=p\n$$\n\n\n## Exemplo 1. Punto de burbulla a unha temperatura dada.\n\n### Enunciado \nUnha mestura líquida contén 50% de moles de pentan, 30% de moles de hexano e 20% de moles de ciclohexano. Calcular a presión do punto de burbulla cando, á temperatura constante de $T$ = 400 K, se reduce progresivamente a presión. Cal é a presión da primeira burbulla que se fiorma e a composición do primero vapor que se forma supoñendo comportamento ideal (__Lei de Raoult__).\n\n### Solución\nDebemos atopar a $p$ que satisfai a ecucaión:\n  \n$$\n\\Sigma_{i} \\underbrace{x_{i} p_{i}^{\\text {siat }}(T)}_{p_{i}}=p\n$$\n  \nEmpezamos calculando a presi´n de vapor de cada compoñente da mestura.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\n# Datos\n\nT             = 400 # K\n\nA_pentano     = 3.97786\nB_pentano     = 1064.840\nC_pentano     = -41.136\nA_hexano      =  4.00139\nB_hexano      = 1170.875\nC_hexano      = -48.833\nA_ciclohexano = 3.93002\nB_ciclohexano = 1182.774\nC_ciclohexano = -52.532\n\nx_pentano     = 0.5\nx_hexano      = 0.3\nx_ciclohexano = 0.2\n```\n:::\n\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\np_sat_pentano     = 10 ** (A_pentano - B_pentano / ( T + C_pentano)) \np_sat_hexano      = 10 ** (A_hexano - B_hexano / ( T + C_hexano)) \np_sat_ciclohexano = 10 ** (A_ciclohexano - B_ciclohexano / ( T + C_ciclohexano)) \n\nprint('Presión de saturación do pentano     = {:8.4f} a {:d} K'.format(p_sat_pentano, T))\nprint('Presión de saturación do hexano      = {:8.4f} a {:d} K'.format(p_sat_hexano, T))\nprint('Presión de saturación do ciclohexano = {:8.4f} a {:d} K ='.format(p_sat_ciclohexano, T))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPresión de saturación do pentano     =  10.2473 a 400 K\nPresión de saturación do hexano      =   4.6468 a 400 K\nPresión de saturación do ciclohexano =   3.3577 a 400 K =\n```\n:::\n:::\n\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\n# presións de vapor\np_pentano     = x_pentano     * p_sat_pentano\np_hexano      = x_hexano      * p_sat_hexano\np_ciclohexano = x_ciclohexano * p_sat_ciclohexano\n\np_burbulla = p_pentano + p_hexano + p_ciclohexano\n\nprint('Presión de burbulla a {:2d} K = {:.4f} bar'.format(T,p_burbulla))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPresión de burbulla a 400 K = 7.1892 bar\n```\n:::\n:::\n\n\nNo punto de burbulla a fase líquida ten unha composición coñecida (os datos do problema). Polo tanto, aplicando __Raoult__, a presión de vapor de cada compoñente é:\n  \n$$\np_{pentano} = x_{pentano} \\cdot p_{pentano}^{sat} \\\\\np_{hexano} = x_{hexano} \\cdot p_{hexano}^{sat} \\\\\np_{ciclohexano} = x_{ciclohexano} \\cdot p_{ciclohexano}^{sat}\n$$\n\nE a presión total:\n  \n$$\np_{burbulla} = p_{pentano} + p_{hexano} + p_{ciclohexano}\n$$\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\n# Cálculo das yi\n\ny_pentano     = p_pentano     / p_burbulla\ny_hexano      = p_hexano      / p_burbulla\ny_ciclohexano = p_ciclohexano / p_burbulla\n\nprint('y_pentano      = {:6.4f}'.format(y_pentano))\nprint('y_hexano       = {:6.4f}'.format(y_hexano))\nprint('y_ciclohexano  = {:6.4f}'.format(y_ciclohexano))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ny_pentano      = 0.7127\ny_hexano       = 0.1939\ny_ciclohexano  = 0.0934\n```\n:::\n:::\n\n\nSe podería sofisticar un pouco mais o código facendo uso do diccionario de datos e das funcións anónimas de ```python```, as funcións lamba. Fagamos o mesmo cálculo\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\ncompostos = ['pentano','hexano','ciclohexano']\n\nPsat = dict()\nPsat['pentano']     = lambda T: 10**(3.97786 - 1064.840/(-41.136 + T))  # log p en mar T en ºC  \nPsat['hexano']      = lambda T: 10**(4.00139 - 1170.875/(-48.833 + T)) # log p en mar T en ºC\nPsat['ciclohexano'] = lambda T: 10**(3.93002 - 1182.774/(-52.532 + T))  # log p en mar T en ºC\nspecies = ['acetone','benzene','toluene']\nz = dict()\nz['pentano'] = 0.5\nz['hexano'] = 0.3\nz['ciclohexano'] = 0.2\n```\n:::\n\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n# Como calculamos puntos de burbulla\nx = z\nfor s in compostos:\n    x[s] = z[s]\n```\n:::\n\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\nT = 400 # K\nPbub =sum([x[s]*Psat[s](T) for s in compostos])\nfor s in compostos:\n    print(f'Presión de vapor do {s} = {x[s]*Psat[s](T):.2f} bar')\n\nprint('Presión de burbulla a {:2d} K = {:.4f} bar'.format(T,Pbub))    \n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPresión de vapor do pentano = 5.12 bar\nPresión de vapor do hexano = 1.39 bar\nPresión de vapor do ciclohexano = 0.67 bar\nPresión de burbulla a 400 K = 7.1892 bar\n```\n:::\n:::\n\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\nfor s in compostos:\n    print(f'Fracción molar no vapor de {s} = {x[s]*Psat[s](T)/Pbub:.4f}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nFracción molar no vapor de pentano = 0.7127\nFracción molar no vapor de hexano = 0.1939\nFracción molar no vapor de ciclohexano = 0.0934\n```\n:::\n:::\n\n\n## Exemplo 2. Punto de burbulla a presión dada.\n\nConsidera a mesma mestura líquida cun 50% molar de pentano, un 30% molar de hexano (2) e un 20% molar de ciclohexano (3). A $p$ = 5 bar, aumenta gradualmente a temperatura. Cal é a temperatura e a composición da burbulla do primeiro vapor que se forma?.\n\n### Solución.\n\nNeste caso imos calcular a temperatura de burbulla apresión constante (caso 2), $p$ e $x_i$ coñécense. polo que a ecuación:\n  \n$$\n\\Sigma_{i} \\underbrace{x_{i} p_{i}^{\\text {siat }}(T)}_{p_{i}}=p\n$$\n  \nconvértese nunha ecuación implícita en $T$ que ten que ser resolta por un método numérico comp pode ser unha iteración. No noso caso usaremos unha librería de python.\n\nPrimeiro imos facelo cun código simple, usando o estilo do cálculo anterior. Xa temos cargado $x[s]$ con valores de $z[s}$, onde $[s]$ son os compostos:\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\nx_pentano     = 0.5\nx_hexano      = 0.3\nx_ciclohexano = 0.2\n\nP = 5 # bar\n\ndef Tbub(T):\n    return P - x_pentano*10**(A_pentano-B_pentano/(T+C_pentano))-x_hexano*10**(A_hexano-B_hexano/(T+C_hexano))-x_ciclohexano*10**(A_ciclohexano-B_ciclohexano/(T+C_ciclohexano))\n\nfrom scipy.optimize import fsolve\nT_guess = 400 # K\nTsol = fsolve(Tbub, T_guess)\nprint (f'A temperatura de burbulla, a presión de {P:.1f} bar é de {Tsol[0]:.2f} K')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nA temperatura de burbulla, a presión de 5.0 bar é de 382.64 K\n```\n:::\n:::\n\n\nNo caso de querer usar un estilo mais condensado, podemos facer como antes e tirar de funcións lambda e diccionario de datos. O código sería o seguinte:\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\nfrom scipy.optimize import fsolve\n\nx = z\nT_guess = 400 # K\n\nP = 5 # bar\ndef Tbub(compostos,x):\n    return fsolve(lambda T : sum([x[s]*Psat[s](T)/P for s in compostos]) - 1.0,T_guess)[0]\n\ndef ybub(species,x):\n    return {s: x[s]*Psat[s](Tbub(compostos,x))/P for s in compostos}\n\nT = Tbub(compostos,x)\ny = ybub(compostos,x)\n\nprint(f'A temperatura de burbulla da mestura é {T:.2f} ºK')\n\nfor s in compostos:\n    print(f'A fracción molar no vapor do compoñente [s] da mestura é {y[s]:.4f}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nA temperatura de burbulla da mestura é 382.64 ºK\nA fracción molar no vapor do compoñente [s] da mestura é 0.7240\nA fracción molar no vapor do compoñente [s] da mestura é 0.1870\nA fracción molar no vapor do compoñente [s] da mestura é 0.0889\n```\n:::\n:::\n\n\n## Cálculos do punto de orballo\n\nConsideremos a continuación os cálculos do punto de orballo. Neste caso, a composición en fase de vapor $y_i$ dáse (corresponde ao caso en que **L** é moi pequeno (L $\\geqq$ 0) e $y_i = z_i$.\n\nO punto de orballo dun vapor (gas) é o punto onde o vapor comeza a condensar, é dicir, cando se forma a primeira pinga de líquido. Se mentén a temperatura,\nentón debemos aumentar a presión ata que se forme o primeiro líquido. Se a o que se mantén é a presión, débese baixar a temperatura ata que se forme o líquido. En ambolosdous casos, isto corresponde a axustar $T$ ou $p$ ata que se cumpra qie:\n  \n$$\n\\sum_i x_i = 1\n$$\n  \nou\n  \n$$\n\\sum_i \\frac {y_i}{K_i} = 1\n$$\n\nonde $y_i$ ven dado. Para unha mestura ideal onde se cumpre a $lei de Raoult$ dá:\n  \n$$\n\\sum_i \\frac { y_i } { P_i^sat (T)} = \\frac { 1 } { p } \n$$\n\n### Exemplo 3. Punto de orballo a determinada temperatura T. \nUnha mestura de vapor contén 50% pentano (1), 30% de hexano (2) e 20% de ciclohexano (3) (todo en mol-%), é dicir, $y_1 = 0.5$, $y_2 = 0.3$ 3 $y_3 = 0.2$. A $T$ = 400 K, e a presión aumentase gradualmente. Cal é a presión do punto de orballo e a composición do primeiro líquido que se forma?. Supón mestura líquida ideal e gas ideal (**lei de Raoult**).\n\n### Solución.\n\nA tarefa é atopar o valor de $p$ que satisfaga a ecuación anterior. Como se dá $T$ constante, isto é trivial. Simplemente podemos calcular a inversa de $p$ a partires da ecuación:\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\nT = 400 # K\ny_pentano     = 0.5\ny_hexano      = 0.3\ny_ciclohexano = 0.2\n\np_sat_pentano     = 10 ** (A_pentano - B_pentano / ( T + C_pentano)) \np_sat_hexano      = 10 ** (A_hexano - B_hexano / ( T + C_hexano)) \np_sat_ciclohexano = 10 ** (A_ciclohexano - B_ciclohexano / ( T + C_ciclohexano))\n\np = 1 / ( y_pentano / p_sat_pentano + y_hexano /p_sat_hexano + y_ciclohexano / p_sat_ciclohexano )\n\nx_pentano     = y_pentano     * p / p_sat_pentano\nx_hexano      = y_hexano      * p / p_sat_hexano\nx_ciclohexano = y_ciclohexano * p / p_sat_ciclohexano\n\nprint(f'Á temperatura de 400 K, a presión de orballo da mestura é de {p:.2f} bar.')\nprint(f' A fracción molar de pentano     no líquido é {x_pentano:.4f}')\nprint(f' A fracción molar de hexano      no líquido é {x_hexano:.4f}')\nprint(f' A fracción molar de ciclohexano no líquido é {x_ciclohexano:.4f}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nÁ temperatura de 400 K, a presión de orballo da mestura é de 5.78 bar.\n A fracción molar de pentano     no líquido é 0.2822\n A fracción molar de hexano      no líquido é 0.3734\n A fracción molar de ciclohexano no líquido é 0.3445\n```\n:::\n:::\n\n\nFacéndoo coas funcións lambda e o diccionario de datos:\n\n::: {.cell execution_count=12}\n``` {.python .cell-code}\ny = z\n\nT = 400 # K\nPorb = 1 / (sum([y[s]/Psat[s](T) for s in compostos]))\n\nfor s in compostos:\n    print(f'Presión de vapor do {s} = {x[s]*Psat[s](T):.2f} bar')\n\nprint('Presión de orballo a {:2d} K = {:.4f} bar'.format(T,Porb))    \n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPresión de vapor do pentano = 5.12 bar\nPresión de vapor do hexano = 1.39 bar\nPresión de vapor do ciclohexano = 0.67 bar\nPresión de orballo a 400 K = 5.7830 bar\n```\n:::\n:::\n\n\nE as fraccións molares no líquido:\n\n::: {.cell execution_count=13}\n``` {.python .cell-code}\nfor s in compostos:\n    print(f'Fracción molar no vapor de {s} = {y[s]*p/Psat[s](T):.4f}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nFracción molar no vapor de pentano = 0.2822\nFracción molar no vapor de hexano = 0.3734\nFracción molar no vapor de ciclohexano = 0.3445\n```\n:::\n:::\n\n\n## Exemplo 4. Punto de orballo á presión dada p.\n\nConsidere a mesma mestura de vapor con 50% pentano (1), 30% hexano (2) e 20% ciclohexano (3). En $p$ = 5 bar, a temperatura báixase gradualmente. Cal é a temperatura do punto de orballo e a composición do primeiro líquido que condensa?.\n\n### Solución.\n\nNeste caso, dannos $p$ e $y_i$ e coñecemos unha ecuación implícita para\n$T$ que debe resolverse numericamente (por exemplo, usando `fsolve`). Imos aló:\n\n::: {.cell execution_count=14}\n``` {.python .cell-code}\ny_pentano     = 0.5\ny_hexano      = 0.3\ny_ciclohexano = 0.2\n\ndef Torb(T):\n    return 1/p-y_pentano/(10**(A_pentano-B_pentano/(T+C_pentano)))-y_hexano/(10**(A_hexano-B_hexano/(T+C_hexano)))-y_ciclohexano/(10**(A_ciclohexano-B_ciclohexano/(T+C_ciclohexano)))\n\np = 5\n\nfrom scipy.optimize import fsolve\n\nT_guess = 400 # K\n\nTsol = fsolve(Torb, T_guess)\n\nprint (f'A temperatura de burbulla, a presión de {P:.1f} bar é de {Tsol[0]:.2f} K')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nA temperatura de burbulla, a presión de 5.0 bar é de 393.30 K\n```\n:::\n:::\n\n\nPara calcular as composición do líquido recurrimos a:\n  \n$$\nx_i = \\frac { y_i p } { P_i^{sat} }\n$$\n  \nLogo:\n\n::: {.cell execution_count=15}\n``` {.python .cell-code}\nT = Tsol[0]\n\np_sat_pentano     = 10 ** (A_pentano - B_pentano / ( T + C_pentano)) \np_sat_hexano      = 10 ** (A_hexano - B_hexano / ( T + C_hexano)) \np_sat_ciclohexano = 10 ** (A_ciclohexano - B_ciclohexano / ( T + C_ciclohexano))\n \nx_pentano = y_pentano * p / p_sat_pentano\nx_hexano = y_hexano * p / p_sat_hexano\nx_ciclohexano = y_ciclohexano * p / p_sat_ciclohexano\n\nprint(f' A fracción molar de pentano     no líquido é {y_pentano * p / p_sat_pentano:.4f}')\nprint(f' A fracción molar de hexano      no líquido é {x_hexano:.4f}')\nprint(f' A fracción molar de ciclohexano no líquido é {x_ciclohexano:.4f}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n A fracción molar de pentano     no líquido é 0.2778\n A fracción molar de hexano      no líquido é 0.3748\n A fracción molar de ciclohexano no líquido é 0.3474\n```\n:::\n:::\n\n\n",
    "supporting": [
      "ptflash_files"
    ],
    "filters": [],
    "includes": {}
  }
}